Использован файл с СК ENU

0) В случае с  истинными углами и магнитными плотностями кватернион всегда [6,123233995736766e-17; 1; 0; 0]. 
Рассмотрен случай с углами R=180[град], P=0, Y=0 и неидеальными датчиками: ошибок никаких нет.

Далее все результаты для случая, когда углы считаем с акселерометра и магнитометра.
1) При использовании идеальных датчиков (все параметры *0):
-R=0, P=0, Y=0:
Все переменные = 0, ошибки = 0;

-R=randn, P=randn, Y=randn:
1. Значения, лежащие в Arpy и ya_rpy одинаковые;
2. В err_RPY лежат ненулевые значения, но стремящиеся к нему ( R=x*e-14, P=x*e15, Y здесь не оценивается поэтому ошибки большие [град]);
3. В err_Azimuth также ненулевые, но стремящиеся к нему(Y=x*e15);

2) Датчики идеальные:
-R=180[град], P=0, Y=0:
1.
На выходе функции rpy2q (Quat_rpy_enu) формируется кватернион 
[6,123233995736766e-17;
1;
0;
0].
2. В err_RPY все значения = 0.

3) Датчики неидеальные:
-R=180[град], P=0, Y=0:
1.
На выходе функции rpy2q (Quat_rpy_enu) формируется кватернион 
[0,0222340242094750;
0,999083586872835;
0,000813724665950887;
-0,0365646340188238]
хотя, казалось, должно быть [0;1;0;0]. Далее из кватерниона формируется матрица C_rpy_enu, то есть в ней уже есть какие-то ошибки, а далее из нее формируется вектор истинных ускорений Arpy. 
2. RPY (истинные углы) отличается от RPY_new (углы от акселерометра): изначально P=0, а в RPY_new уже не нули. Поэтому ошибки в err_RPY есть и по R, и по P.

4) Берём более точный IMU ADIS16488A:
-R=180[град], P=0, Y=0:
1. Теперь кватернион выглядит так:
[0,00596344514869340;
0,999916620876621;
6,83083499018537e-05;
-0,0114535562428179]
Все идет также как в предыдущем пункте, ошибки есть по R и P, при этом ошибки по P больше, чем по R (например, R = 0,619242248411109	P = -1,18767593459832	Y = 0 [град]).
Видно, что с MPU9250 они значительно выше, чем с ADIS16488A. 

5) Повторяем предыдущий эксперимент для MPU9250, но теперь углы такие:
-R=0 [град], P=90, Y=0:
В RPY_new снова есть и R, и P. Конечный результат такой: (например) : R = -142,494708740561, P = 7,08862138577016, Y =0.

